#!/usr/bin/php
<?php
$autoloadPath1 = __DIR__ . '/../../../autoload.php';
$autoloadPath2 = __DIR__ . '/../vendor/autoload.php';
if (file_exists($autoloadPath1)) {
    require_once $autoloadPath1;
} else {
    require_once $autoloadPath2;
}

use function \cli\line;
use function \cli\prompt;
use function BrainGames\even\playEven;

function greet() {
    line('Welcome to the Brain Games!');
    line('Answer "yes" if number even otherwise answer "no"');
}

function getPlayerName() {
    $name = prompt('May I have your name?');
    line('Hello, %s',$name);
    return $name;
}


function run()
{
    greet();
    $playerName = getPlayerName();
    $correctAnswerCounter = 0;
    while($correctAnswerCounter < 3) {
        $gameStage = playEven();
        line('Question: %d', $gameStage[0]);
        $playerAnswer = prompt('Your answer: ');
        if ($gameStage[1] == $playerAnswer) {
            $correctAnswerCounter += 1;
            line('Correct!');
        } else {
            line('"%s" is wrong answer ;(. Correct answer was "%s".',$gameStage[0],$gameStage[1]);
            line('Let`s try again, %s', $playerName);
            break;
        }
    }
    if ($correctAnswerCounter == 3) {
        line('Congratulations, %s!', $playerName);
    }
}

run();